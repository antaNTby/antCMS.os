{include file="atoms/aBreadcrump.tpl.html"}
{include file="atoms/aPageH1.tpl.html"}
<div class="d-flex align-items-center gap-4">
    <div class="w-50 d-flex flex-column flex-md-row align-items-center gap-2">
        <label for="configSelector" class="form-check-label text-nowrap">Выбрать конфигурацию</label>
        <select name="configSelector" id="configSelector" class="form-select">
            {section name=tt loop=$allTablesNames}
            {if $smarty.section.tt.index == $configSelectedIndex}
            {assign var=isSelected value="selected=selected"}{else}{assign var=isSelected value=""}
            {/if}
            <option {$isSelected} value="{$smarty.section.tt.index}">{$smarty.section.tt.index} - {$allTablesNames[$smarty.section.tt.index]}</option>
            {/section}
        </select>
        <div class="form-check form-switch align-items-center" title="Снять запрет">
            <input class="form-check-input" type="checkbox" role="switch" name="switcherFieldsetToggle" id="switcherFieldsetToggle" aria-labelledby="selectConfigFieldset">
            <label class="form-check-label" for="switcherFieldsetToggle"><i class="bi bi-lock-fill text-danger"></i></label>
        </div>
    </div>
    <fieldset class="w-50 d-flex flex-column flex-md-row align-items-center gap-2" id="selectConfigFieldset" disabled>
        <button type="button" class="btn btn-dark w-100 text-nowrap" data-operation="addNewConfig">Создать/Обновить конфиг <i class="bi bi-database-add"></i></button>
        <button type="button" class="btn btn-primary w-100 text-nowrap" data-operation="ssss">Импортировать из `*__columns.json`<i class="bi bi-edit"></i></button>
        <button type="button" class="btn btn-danger w-100 text-nowrap" data-operation="ssss">Переписать `*__columns.json` <i class="bi bi-edit"></i></button>
    </fieldset>
</div>
<hr>
<div class="table-responsive-xl mb-4">
    {assign var ="countTD" value=11}
    <table id="columnsConfiguratorTable" class="table table-striped table-bordered table-sm">
        <thead class="table-secondary">
            <tr class="ant-text-rotated align-self-center align-middle text-center">
                <td class="ant-text-no-rotated">#</td>
                <th>data</th>
                <td>ind</td>
                <td>db</td>
                <td>dt</td>
                <th class="ant-text-no-rotated">title</th>
                <td>visible</td>
                <td>searchable</td>
                <td>orderable</td>
                {* <td>editable</td> *}
                <td>sort order</td>
                <th>enable</th>
                {* <td class="ant-text-no-rotated">actions</td> *}
                {* <td class="ant-text-no-rotated">sql_type</td> *}
                <td class="ant-text-no-rotated">input_type</td>
            </tr>
        </thead>
        <tbody>
            {assign var ="FieldsCount" value=$dbTableFields|@count}
            {if $iuConfigs}
            {section name=row loop=$FieldsCount}
            <tr class="align-items-center">
                {assign var ="rowData" value=$iuConfigs[$smarty.section.row.index]}
                {assign var ="colData" value=$rowData.table_data}
                {assign var ="p" value=$rowData.p}
                {assign var ="datalist" value=$rowData.datalist}
                {assign var ="data_set"  value=$rowData.dataset}
                <td>{$smarty.section.row.index}&nbsp;<sub><span class="badge text-bg-light">{$colData.id}</span></sub></td>
                <td><small class="opacity-25">{$colData.data}</small>{include file="cs/single_plaintext.tpl" p=$p.data  dataset=$data_set.data}</td>
                <td><small class="opacity-25">{$colData.ind}</small>{include file="cs/single_plaintext.tpl" p=$p.ind  dataset=$data_set.ind}</td>
                <td><small class="opacity-25">{$colData.db}</small>{include file="cs/single_inputtext.tpl" p=$p.db datalist=$datalist.db  dataset=$data_set.db}</td>
                <td><small class="opacity-25">{$colData.dt}</small>{include file="cs/single_inputtext.tpl" p=$p.dt datalist=$datalist.dt  dataset=$data_set.dt}</td>
                <td><small class="opacity-25">{$colData.title}</small>{include file="cs/single_inputtext.tpl" p=$p.title  dataset=$data_set.title}</td>
                <td><small class="opacity-25">{$colData.visible}</small>{include file="cs/single_checkbox.tpl" p=$p.visible  dataset=$data_set.visible}</td>
                <td><small class="opacity-25">{$colData.searchable}</small>{include file="cs/single_checkbox.tpl" p=$p.searchable  dataset=$data_set.searchable}</td>
                <td><small class="opacity-25">{$colData.orderable}</small>{include file="cs/single_checkbox.tpl" p=$p.orderable  dataset=$data_set.orderable}</td>
                {* <td><small class="opacity-25">{$colData.editable}</small>{include file="cs/single_checkbox.tpl" p=$p.editable  dataset=$data_set.editable}</td> *}
                <td><small class="opacity-25">{$colData.sort_order}</small>{include file="cs/single_inputnumber.tpl" p=$p.sort_order  dataset=$data_set.sort_order}</td>
                <td><small class="opacity-25">{$colData.enable}</small>{include file="cs/single_checkbox.tpl" p=$p.enable  dataset=$data_set.enable}</td>
                {* <td><small class="opacity-25">{$colData.actions}</small>{include file="cs/single_checkbox.tpl" p=$p.actions  dataset=$data_set.actions}</td> *}
                {* <td><small class="opacity-25">{$colData.sql_type}</small>{include file="cs/single_checkbox.tpl" p=$p.sql_type  dataset=$data_set.sql_type}</td> *}
                <td><small class="opacity-25">{$colData.input_type}</small>{include file="cs/single_inputtext.tpl" p=$p.input_type  dataset=$data_set.input_type}</td>
            </tr>
            {/section}
            {else}
            {include file="atoms/aEmptyTableBodyWithPlaceholders.tpl.html"  progressPercent="50" countTD=$countTD|default:11}
            {/if}
        </tbody>
        <tfoot class="table-dark">
        </tfoot>
    </table>


</div>
<div class="shadow p-3 mb-5 mt-3 bg-body-tertiary rounded border border-1">
    <form class="p-3" action="save_defaultForm1">
        <input type="text" id="jsonFN" value="{$columnsJsonFileName}">
        <button class="btn btn-success btn-lg" id="btnSubmit" name="btnSubmit">save</button>
    </form>
</div>
<script src="/admin/js/ui/sub/conf_columns.js" type="module"></script>
{* {$datalist.db|debug_print_var|unescape:"entity"}<br> *}
{$dataset|debug_print_var|unescape:"entity"}<br>